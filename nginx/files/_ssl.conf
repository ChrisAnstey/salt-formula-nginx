
  {%- if site.get('ssl', {'enabled': False}).get('enabled', False) %}
  ssi on;
  ssl on;
  ssl_session_cache shared:SSL:10m;
  ssl_session_timeout  10m;
  {%- if site.ssl.engine is not defined %}
  ssl_certificate_key /etc/ssl/private/{{ site.host.name }}.key;
  ssl_certificate /etc/ssl/certs/{{ site.host.name }}-with-chain.crt;
  {%- elif site.ssl.engine == 'letsencrypt' %}
  ssl_certificate         /etc/letsencrypt/live/{{ site.host.name }}/fullchain.pem;
  ssl_certificate_key     /etc/letsencrypt/live/{{ site.host.name }}/privkey.pem;
  ssl_trusted_certificate /etc/letsencrypt/live/{{ site.host.name }}/fullchain.pem;
  {%- endif %}
  {%- set ssl_mode = site.ssl.get('mode', 'secure') %}
  {%- include "nginx/files/_ssl_"+ssl_mode+".conf" %}
  {%- endif %}
